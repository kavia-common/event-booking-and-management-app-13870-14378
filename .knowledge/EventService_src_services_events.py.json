{"is_source_file": true, "format": "Python", "description": "This file contains service-layer functions for managing events in an event booking platform, including creating, retrieving, listing, updating, deleting, favoriting, and analytics. It interfaces with a database abstraction (DB) and defines business logic with validation and transformation functions.", "external_files": ["src.domain.models", "src.domain.schemas", "src.security.deps", "fastapi"], "external_methods": ["status.HTTP_403_FORBIDDEN", "status.HTTP_404_NOT_FOUND", "DB.generate_id()"], "published": ["create_event", "get_event", "list_events", "update_event", "delete_event", "favorite_event", "unfavorite_event", "organizer_events", "analytics_summary", "platform_analytics"], "classes": [], "methods": [{"name": "TicketTypePublic _to_ticket_public(t: TicketType)", "description": "Transforms a TicketType object to its public schema representation.", "scope": "", "scopeKind": ""}, {"name": "EventPublic _to_event_public(e: Event)", "description": "Transforms an Event object to its public schema representation, including nested ticket types.", "scope": "", "scopeKind": ""}, {"name": "Tuple[List[Event],int] _paginate(items: List[Event], page: int, page_size: int)", "description": "Paginates a list of Event objects based on page number and size.", "scope": "", "scopeKind": ""}, {"name": "EventPublic create_event(payload: EventCreate, user: CurrentUser)", "description": "Creates a new event with validation on organizer permissions and initializes ticket types.", "scope": "", "scopeKind": ""}, {"name": "EventPublic get_event(event_id: str, increment_view: bool = False)", "description": "Retrieves event by ID with optional view count increment.", "scope": "", "scopeKind": ""}, {"name": "EventList list_events( q: Optional[str], category: Optional[str], location: Optional[str], status_filter: Optional[EventStatus], start_from: Optional[datetime], start_to: Optional[datetime], tags: Optional[List[str]], page: int, page_size: int, sort_by: Optional[str], sort_dir: str = \"desc\", )", "description": "Filters, sorts, and paginates events for public discovery based on query parameters.", "scope": "", "scopeKind": ""}, {"name": "EventPublic update_event(event_id: str, payload: EventUpdate, user: CurrentUser)", "description": "Updates event details, allowing only organizer or admin to modify.", "scope": "", "scopeKind": ""}, {"name": "None delete_event(event_id: str, user: CurrentUser)", "description": "Deletes an event, only accessible by admin or owning organizer.", "scope": "", "scopeKind": ""}, {"name": "EventPublic favorite_event(event_id: str, user: CurrentUser)", "description": "Increments the favorite count for an event (toggle on).", "scope": "", "scopeKind": ""}, {"name": "EventPublic unfavorite_event(event_id: str, user: CurrentUser)", "description": "Decrements the favorite count for an event (toggle off).", "scope": "", "scopeKind": ""}, {"name": "EventList organizer_events( organizer_id: str, status_filter: Optional[EventStatus], page: int, page_size: int, user: CurrentUser, )", "description": "Lists events belonging to a specific organizer, with permission checks.", "scope": "", "scopeKind": ""}, {"name": "AnalyticsSummary analytics_summary(event_id: str, user: CurrentUser)", "description": "Provides analytics data for an event, accessible only by owner or admin.", "scope": "", "scopeKind": ""}, {"name": "dict platform_analytics(user: CurrentUser)", "description": "Aggregates global analytics across all events, restricted to admins.", "scope": "", "scopeKind": ""}], "search-terms": ["event creation", "event listing", "event update", "ticket types", "analytics", "favorite toggle", "organizer event list", "public event filtering"], "state": 2, "file_id": 9, "knowledge_revision": 19, "git_revision": "", "ctags": [{"_type": "tag", "name": "_paginate", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def _paginate(items: List[Event], page: int, page_size: int) -> Tuple[List[Event], int]:$/", "language": "Python", "typeref": "typename:Tuple[List[Event],int]", "kind": "function", "signature": "(items: List[Event], page: int, page_size: int)"}, {"_type": "tag", "name": "_to_event_public", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def _to_event_public(e: Event) -> EventPublic:$/", "language": "Python", "typeref": "typename:EventPublic", "kind": "function", "signature": "(e: Event)"}, {"_type": "tag", "name": "_to_ticket_public", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def _to_ticket_public(t: TicketType) -> TicketTypePublic:$/", "language": "Python", "typeref": "typename:TicketTypePublic", "kind": "function", "signature": "(t: TicketType)"}, {"_type": "tag", "name": "analytics_summary", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def analytics_summary(event_id: str, user: CurrentUser) -> AnalyticsSummary:$/", "language": "Python", "typeref": "typename:AnalyticsSummary", "kind": "function", "signature": "(event_id: str, user: CurrentUser)"}, {"_type": "tag", "name": "create_event", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def create_event(payload: EventCreate, user: CurrentUser) -> EventPublic:$/", "language": "Python", "typeref": "typename:EventPublic", "kind": "function", "signature": "(payload: EventCreate, user: CurrentUser)"}, {"_type": "tag", "name": "delete_event", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def delete_event(event_id: str, user: CurrentUser) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(event_id: str, user: CurrentUser)"}, {"_type": "tag", "name": "favorite_event", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def favorite_event(event_id: str, user: CurrentUser) -> EventPublic:$/", "language": "Python", "typeref": "typename:EventPublic", "kind": "function", "signature": "(event_id: str, user: CurrentUser)"}, {"_type": "tag", "name": "get_event", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def get_event(event_id: str, increment_view: bool = False) -> EventPublic:$/", "language": "Python", "typeref": "typename:EventPublic", "kind": "function", "signature": "(event_id: str, increment_view: bool = False)"}, {"_type": "tag", "name": "list_events", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def list_events($/", "language": "Python", "typeref": "typename:EventList", "kind": "function", "signature": "( q: Optional[str], category: Optional[str], location: Optional[str], status_filter: Optional[EventStatus], start_from: Optional[datetime], start_to: Optional[datetime], tags: Optional[List[str]], page: int, page_size: int, sort_by: Optional[str], sort_dir: str = \"desc\", )"}, {"_type": "tag", "name": "organizer_events", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def organizer_events($/", "language": "Python", "typeref": "typename:EventList", "kind": "function", "signature": "( organizer_id: str, status_filter: Optional[EventStatus], page: int, page_size: int, user: CurrentUser, )"}, {"_type": "tag", "name": "platform_analytics", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def platform_analytics(user: CurrentUser) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "(user: CurrentUser)"}, {"_type": "tag", "name": "unfavorite_event", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def unfavorite_event(event_id: str, user: CurrentUser) -> EventPublic:$/", "language": "Python", "typeref": "typename:EventPublic", "kind": "function", "signature": "(event_id: str, user: CurrentUser)"}, {"_type": "tag", "name": "update_event", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/services/events.py", "pattern": "/^def update_event(event_id: str, payload: EventUpdate, user: CurrentUser) -> EventPublic:$/", "language": "Python", "typeref": "typename:EventPublic", "kind": "function", "signature": "(event_id: str, payload: EventUpdate, user: CurrentUser)"}], "hash": "79f2144c43f1b50df498b42b0e280237", "format-version": 4, "code-base-name": "EventService", "filename": "EventService/src/services/events.py", "revision_history": [{"19": ""}]}