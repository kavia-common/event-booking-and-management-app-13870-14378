{"is_source_file": true, "format": "Python", "description": "This file defines security-related dependencies and classes for user authentication and role-based authorization in a FastAPI application. It includes a CurrentUser class to represent user claims derived from request headers, functions to extract user info (`get_current_user`), and role requirement checks (`require_organizer`, `require_admin`).", "external_files": ["src.core.config"], "external_methods": ["get_settings"], "published": ["get_current_user", "require_organizer", "require_admin"], "classes": [{"name": "CurrentUser", "description": "Represents the current user's claims, including user ID and roles, and provides methods to check role memberships."}], "methods": [{"name": "CurrentUser get_current_user( x_user_id: Optional[str] = Header(default=None, alias=\"x-user-id\"), x_user_roles: Optional[str] = Header(default=\"\", alias=\"x-user-roles\"), x_api_key: Optional[str] = Header(default=None, alias=None), )", "description": "Creates a CurrentUser instance based on request headers, enforcing API key validation if configured.", "scope": "", "scopeKind": ""}, {"name": "CurrentUser require_organizer(user: CurrentUser = Depends(get_current_user))", "description": "Dependency that ensures the current user has 'organizer' privileges; raises HTTP 403 if not.", "scope": "", "scopeKind": ""}, {"name": "CurrentUser require_admin(user: CurrentUser = Depends(get_current_user))", "description": "Dependency that ensures the current user has 'admin' privileges; raises HTTP 403 if not.", "scope": "", "scopeKind": ""}, {"name": "__init__(self, user_id: str, roles: list[str])", "scope": "CurrentUser", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_admin(self)", "scope": "CurrentUser", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_attendee(self)", "scope": "CurrentUser", "scopeKind": "class", "description": "unavailable"}, {"name": "bool is_organizer(self)", "scope": "CurrentUser", "scopeKind": "class", "description": "unavailable"}], "calls": ["get_settings", "Header", "Depends", "HTTPException", "status.HTTP_401_UNAUTHORIZED", "status.HTTP_403_FORBIDDEN"], "search-terms": ["security dependencies", "FastAPI headers", "CurrentUser class", "role-based access control", "API gateway user claims"], "state": 2, "file_id": 8, "knowledge_revision": 17, "git_revision": "", "ctags": [{"_type": "tag", "name": "CurrentUser", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/security/deps.py", "pattern": "/^class CurrentUser:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/security/deps.py", "pattern": "/^    def __init__(self, user_id: str, roles: list[str]):$/", "language": "Python", "kind": "member", "signature": "(self, user_id: str, roles: list[str])", "scope": "CurrentUser", "scopeKind": "class"}, {"_type": "tag", "name": "get_current_user", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/security/deps.py", "pattern": "/^def get_current_user($/", "language": "Python", "typeref": "typename:CurrentUser", "kind": "function", "signature": "( x_user_id: Optional[str] = Header(default=None, alias=\"x-user-id\"), x_user_roles: Optional[str] = Header(default=\"\", alias=\"x-user-roles\"), x_api_key: Optional[str] = Header(default=None, alias=None), )"}, {"_type": "tag", "name": "is_admin", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/security/deps.py", "pattern": "/^    def is_admin(self) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self)", "scope": "CurrentUser", "scopeKind": "class"}, {"_type": "tag", "name": "is_attendee", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/security/deps.py", "pattern": "/^    def is_attendee(self) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self)", "scope": "CurrentUser", "scopeKind": "class"}, {"_type": "tag", "name": "is_organizer", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/security/deps.py", "pattern": "/^    def is_organizer(self) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "member", "signature": "(self)", "scope": "CurrentUser", "scopeKind": "class"}, {"_type": "tag", "name": "require_admin", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/security/deps.py", "pattern": "/^def require_admin(user: CurrentUser = Depends(get_current_user)) -> CurrentUser:$/", "language": "Python", "typeref": "typename:CurrentUser", "kind": "function", "signature": "(user: CurrentUser = Depends(get_current_user))"}, {"_type": "tag", "name": "require_organizer", "path": "/home/kavia/workspace/code-generation/event-booking-and-management-app-13870-14378/EventService/src/security/deps.py", "pattern": "/^def require_organizer(user: CurrentUser = Depends(get_current_user)) -> CurrentUser:$/", "language": "Python", "typeref": "typename:CurrentUser", "kind": "function", "signature": "(user: CurrentUser = Depends(get_current_user))"}], "hash": "4fd1bfd141b3ca0c3c593aeda66f5bf3", "format-version": 4, "code-base-name": "EventService", "filename": "EventService/src/security/deps.py", "revision_history": [{"17": ""}]}